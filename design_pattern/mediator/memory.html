<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>中介者模式--购买商品</title>
</head>
<body>
  选择颜色：<select id="colorSelect">
            <option value="">请选择</option>
            <option value="red">红色</option>
            <option value="blue">蓝色</option>
          </select>
  选择内存: <select id="memorySelect">
            <option value="">请选择</option>
            <option value="32G">32G</option>
            <option value="16G">16G</option>
          </select>
          
  输入购买数量：<input type="text" id="numberInput" />
  <br/>
  您选择了颜色：<div id="colorInfo"></div>
  您输入了数量：<div id="numberInfo"></div>
  您选择了内存：<div id="memoryInfo"></div>
  <button id="nextBtn" disabled="true">请选择手机颜色和购买数量</button>
  <script>
    const goods = {
      "red|32G": 3,
      "red|16G": 0,
      "blue|32G": 1,
      "blue|16G": 6
    };

    const colorSelect = document.querySelector('#colorSelect'),
      numberInput = document.querySelector('#numberInput'),
      colorInfo = document.querySelector('#colorInfo'),
      numberInfo = document.querySelector('#numberInfo'),
      memorySelect = document.querySelector('#memorySelect'),
      memoryInfo = document.querySelector('#memoryInfo')
      nextBtn = document.querySelector('#nextBtn');

    colorSelect.onchange = function() {
      let color = this.value,
        memory = memorySelect.value,
        number = numberInput.value,
        stock = goods[color+'|'+memory];
      
      colorInfo.innerHTML = color;
      if (!color) {
        nextBtn.disabled = true;
        nextBtn.innerHTML = '请选择手机颜色';
        return;
      } 
      if (!memory) {
        nextBtn.disabled = true;
        nextBtn.innerHTML = '请选择内存大小';
        return;
      }
      if (Number.isInteger(number) && number > 0) {
        next.disabled = true;
        nextBtn.innerHTML = '请输入正确的购买数量';
        return;
      }
      if (number > stock) {
        nextBtn.disabled = true;
        nextBtn.innerHTML = '库存不足';
        return;
      }
      nextBtn.disabled = false;
      nextBtn.innerHTML = '收入购物车';
    }
    memorySelect.onchange = function() {
      let color = this.value,
        memory = memorySelect.value,
        number = numberInput.value,
        stock = goods[color+'|'+memory];
      
      memoryInfo.innerHTML = memory;
      if (!color) {
        nextBtn.disabled = true;
        nextBtn.innerHTML = '请选择手机颜色';
        return;
      }
      if (!memory) {
        nextBtn.disabled = true;
        nextBtn.innerHTML = '请选择内存大小';
        return;
      }
      if (Number.isInteger(number) && number > 0) {
        next.disabled = true;
        nextBtn.innerHTML = '请输入正确的购买数量';
        return;
      }
      if (number > stock) {
        nextBtn.disabled = true;
        nextBtn.innerHTML = '库存不足';
        return;
      }
      nextBtn.disabled = false;
      nextBtn.innerHTML = '收入购物车';
    }
    numberInput.oninput = function() {
      let color = colorSelect.value,
        memory = memorySelect.value,
        number = this.value,
        stock = goods[color + '|' + memory];
      numberInfo.innerHTML = number;

      if (!color) {
        nextBtn.disabled = true;
        nextBtn.innerHTML = '请选择手机颜色';
        return;
      }

      if (!memory) {
        nextBtn.disabled = true;
        nextBtn.innerHTML = '请选择内存大小';
        return;
      }

      if (Number.isInteger(number) && number > 0) {
        nextBtn.disabled = true;
        nextBtn.innerHTML = '请输入正确的购买数量';
        return;
      }
      // console.log(number > stock);
      if (number > stock) {
        nextBtn.disabled = true;
        nextBtn.innerHTML = '库存不足';
        return
      }
      nextBtn.disabled = false;
      nextBtn.innerHTML = '放入购物车';
    }
    
  </script>
</body>
</html>